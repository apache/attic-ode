<process name="foreach1-2.0"
         targetNamespace="http://pxe/bpel/unit-test"
         xmlns:bpws="http://schemas.xmlsoap.org/ws/2004/03/business-process/"
         xmlns="http://schemas.xmlsoap.org/ws/2004/03/business-process/"
         xmlns:tns="http://pxe/bpel/unit-test"
         xmlns:xsd="http://www.w3.org/2001/XMLSchema"
         xmlns:test="http://pxe/bpel/unit-test.wsdl"
         suppressJoinFailure="yes">

  <import location="./test.wsdl"
          namespace="http://pxe/bpel/unit-test"
          importType="http://schemas.xmlsoap.org/wsdl/" />

  <partnerLinks>
    <partnerLink name="testPartnerLink"
                 partnerLinkType="test:TestPartnerLinkType"
                 myRole="me" />
  </partnerLinks>

  <variables>
    <variable name="var1" messageType="test:TestMessage1"/>
    <variable name="calc" type="xsd:unsignedInt"/>
    <variable name="var2" messageType="test:TestMessage2"/>
  </variables>

  <sequence>
    <receive createInstance="yes" name="startReceive" partnerLink="testPartnerLink"
            portType="test:TestPortType" operation="testOperation" variable="var1"/>
    <assign name="calc-init">
      <copy>
        <from>0</from>
        <to variable="calc"/>
      </copy>
    </assign>
    <sequence name="seq1">
      <forEach counterName="counterVar" parallel="yes">
        <startCounterValue>0</startCounterValue>
        <finalCounterValue>10</finalCounterValue>
        <scope name="sc1">
          <assign name="a1">
            <copy>
              <from>$counterVar + $calc</from>
              <to>$calc</to>
            </copy>
          </assign>
        </scope>
      </forEach>
    </sequence>
    <assign name="put-result">
      <copy>
        <from>$calc</from>
        <to variable="var2" part="TestPart2"/>
      </copy>
    </assign>
    <reply name="endReply" operation="testOperation" partnerLink="testPartnerLink"
           portType="test:TestPortType" variable="var2"/>
  </sequence>

</process>

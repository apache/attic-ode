<process name="flow3-2.0"
  targetNamespace="http://pxe/bpel/unit-test"
  xmlns:bpws="http://schemas.xmlsoap.org/ws/2004/03/business-process/"
  xmlns="http://schemas.xmlsoap.org/ws/2004/03/business-process/"
  xmlns:tns="http://pxe/bpel/unit-test"
  xmlns:xsd="http://www.w3.org/2001/XMLSchema"
  xmlns:test="http://pxe/bpel/unit-test.wsdl">

  <import importType="http://schemas.xmlsoap.org/wsdl/"
    location="test.wsdl"
    namespace="http://pxe/bpel/unit-test.wsdl" />

  <partnerLinks>
    <partnerLink name="testPartnerLink"
      partnerLinkType="test:TestPartnerLinkType"
      myRole="me"/>
  </partnerLinks>
  <variables>
    <variable name="var1" messageType="test:TestMessage1"/>
    <variable name="tmp1" type="xsd:string"/>
    <variable name="tmp2" type="xsd:string"/>
  </variables>
  <sequence>
    <receive name="startReceive"
      partnerLink="testPartnerLink"
      portType="test:TestPortType"
      createInstance="yes"
      operation="testOperation" variable="var1"/>
    <flow>
      <links>
        <link name="link-a"/>
      </links>
      <empty name="a">
        <sources>
          <!-- transition condition will not be satisfied -->
          <source linkName="link-a">
            <transitionCondition>
	    	$var1/TestPart = '123'
            </transitionCondition>
          </source>
        </sources>
      </empty>
      <scope>
        <faultHandlers>
          <catch faultName="bpws:joinFailure">
            <assign>
              <copy>
                <from>'xyz'</from>
                <to>$var1/TestPart</to>
              </copy>
            </assign>
          </catch>
        </faultHandlers>
        <!-- this should cause join failure -->
        <assign name="b">
          <targets>
            <target linkName="link-a"/>
          </targets>
          <copy>
            <from>'def'</from>
            <to>$var1/TestPart</to>
          </copy>
        </assign>
      </scope>
    </flow>
    <reply name="endReply"
      operation="testOperation"
      partnerLink="testPartnerLink"
      portType="test:TestPortType"
      variable="var1"/>
  </sequence>
</process>

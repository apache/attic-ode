<!-- 
	JBoss 'Sar' for ODE deployment.  This is an alternative to
	deployment using the ODE kernel mbean (see jboss-odekernel-service.xml).
	
	Deployment using this service configuration has no dependency
	on the jboss-odekernel-config.xml configuration.
-->
<server>
  <classpath codebase="file:/${ode.home}/bin" archives="kernel-boot.jar"/>
  <classpath codebase="file:/${ode.home}/ode-lib" archives="*"/>
  <classpath codebase="file:/${ode.home}/lib" archives="*"/>
      
  <mbean name="com.fivesight.ode:mod=JmxRmiRegistry" 
    	   code="org.apache.ode.kernel.modrmi.ModRmiRegistry">
	 <attribute name="Port">2099</attribute>
  </mbean>
  
  <!-- Provide JmxRemoting capabilities on port 2099 -->
  <mbean name="com.fivesight.ode:mod=JmxRemote" 
  		 code="org.apache.ode.kernel.modjmxremote.ModJmxRemote">
	<attribute name="JmxURL">service:jmx:rmi:///jndi/rmi://localhost:2099/server</attribute>
  </mbean>
  
  <!-- log all bpel events to the logger -->
  <mbean name="com.fivesight.ode:mod=BpelLogger" code="org.apache.ode.kernel.modbpellog.ModBpelEventLogger"/>
  
  <mbean name="com.fivesight.ode:mod=HibernateDAO" code="org.apache.ode.kernel.modhibernatedao.ModHibernateDAO">
    <depends>jboss.jca:service=DataSourceBinding,name=odeDS</depends>   
    <attribute name="BpelStateStoreConnectionFactory">bpel_sscf</attribute>
    <attribute name="StateStoreConnectionFactory">sscf</attribute>
    <attribute name="TransactionManager">java:TransactionManager</attribute>
    <attribute name="DataSource">java:odeDS</attribute>
    <attribute name="HibernateProperties">file:${ode.home}/etc/hibernate.properties</attribute>
  </mbean>
  
   <!-- Begin definition of service providers 
	   MUST PROCEED ModSfwk
	-->  
  <mbean name="com.fivesight.ode:mod=ServiceProvider,name=HttpSoap" code="org.apache.ode.kernel.modsfwk.ModSvcProvider">
	<attribute name="JndiName">HttpSoapSP</attribute>
	<attribute name="TransactionManagerName">java:TransactionManager</attribute>
	<attribute name="ProviderClass">org.apache.ode.httpsoap.HttpSoapAdapter</attribute>
	<attribute name="ProviderURI">uri:protocoladapter.soap</attribute>
  </mbean>
  
  <mbean name="com.fivesight.ode:mod=ServiceProvider,name=Bpel" code="org.apache.ode.kernel.modsfwk.ModSvcProvider">
	<depends>fivesight.ode:mod=HibernateDAO</depends>
	<attribute name="JndiName">BpelSP</attribute>
	<attribute name="TransactionManagerName">java:TransactionManager</attribute>
	<attribute name="ProviderClass">org.apache.ode.bpel.provider.BpelServiceProvider</attribute>
	<attribute name="ProviderURI">uri:bpelProvider</attribute>
	<attribute name="ProviderProperties">stateStoreConnectionFactory=bpel_sscf</attribute>
  </mbean>
  
  <mbean name="com.fivesight.ode:mod=ServiceProvider,name=Transformer" code="org.apache.ode.kernel.modsfwk.ModSvcProvider">
	<attribute name="JndiName">XsltSP</attribute>
	<attribute name="TransactionManagerName">java:TransactionManager</attribute>
	<attribute name="ProviderClass">org.apache.ode.xcontrib.sp.xslt.XSLTServiceProvider</attribute>
	<attribute name="ProviderURI">uri:xsltServiceProvider</attribute>
  </mbean>
  
  <mbean name="com.fivesight.ode:mod=ServiceProvider,name=Native" code="org.apache.ode.kernel.modsfwk.ModSvcProvider">
	<attribute name="JndiName">NativeSP</attribute>
	<attribute name="TransactionManagerName">java:TransactionManager</attribute>
	<attribute name="ProviderClass">org.apache.ode.xcontrib.sp.rpc.RpcAdapter</attribute>
	<attribute name="ProviderURI">uri:protocoladapter.native.inbound</attribute>
  </mbean>
  
  <mbean name="com.fivesight.ode:mod=ServiceProvider,name=Spexerciser" code="org.apache.ode.kernel.modsfwk.ModSvcProvider">
	<attribute name="JndiName">SpexerciserSP</attribute>
	<attribute name="TransactionManagerName">java:TransactionManager</attribute>
	<attribute name="ProviderClass">org.apache.ode.bpel.test.BpelTestServiceProvider</attribute>
	<attribute name="ProviderURI">uri:protocoladapter.bpel.unit-test</attribute>
  </mbean>
  

  <mbean name="com.fivesight.ode:mod=ODE" code="org.apache.ode.kernel.modsfwk.ModSfwk">
    <depends>fivesight.ode:mod=HibernateDAO</depends>
	<depends>fivesight.ode:mod=ServiceProvider,name=HttpSoap</depends>
	<depends>fivesight.ode:mod=ServiceProvider,name=Bpel</depends>
	<depends>fivesight.ode:mod=ServiceProvider,name=Transformer</depends>
	<depends>fivesight.ode:mod=ServiceProvider,name=Native</depends>
	<depends>fivesight.ode:mod=ServiceProvider,name=Spexerciser</depends>
    <attribute name="DomainId">MyDomain</attribute>
    <attribute name="RegistryPort">2099</attribute>
    <attribute name="TransactionManager">java:TransactionManager</attribute>
    <attribute name="DAOConnectionFactory">sscf</attribute>
	<attribute name="SvcProviderJndiBindings">HttpSoapSP,BpelSP,XsltSP,NativeSP,SpexerciserSP</attribute>
  </mbean>

  <mbean name="com.fivesight.ode:mod=Deployer" code="org.apache.ode.kernel.moddeployer.ModDeployer">
    <depends>fivesight.ode:mod=ODE</depends>
    <attribute name="DeployDir">${ode.home}/etc/deploy</attribute>
    <attribute name="DomainAdminMBean">fivesight.ode:domain=MyDomain,node=node0,type=DomainAdmin</attribute>
  </mbean>
   
</server>    

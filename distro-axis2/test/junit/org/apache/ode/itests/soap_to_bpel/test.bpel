<process name="loanApprovalProcess"
         targetNamespace="http://acme.com/loanprocessing"
         xmlns="http://schemas.xmlsoap.org/ws/2003/03/business-process/"
         xmlns:bpws="http://schemas.xmlsoap.org/ws/2003/03/business-process/"
         xmlns:lns="http://loans.org/wsdl/loan-approval"
         suppressJoinFailure="yes">

   <partnerLinks>
      <partnerLink name="customerA"
               partnerLinkType="lns:loanPartnerLinkType"
               myRole="loanService"/>
      <partnerLink name="customerB"
               partnerLinkType="lns:loanPartnerLinkType"
               myRole="loanService"/>
     <partnerLink name="echoer"
               partnerLinkType="lns:loanPartnerLinkType"
               partnerRole="loanService"/>
   </partnerLinks>

   <variables>
     <variable name="request"
                messageType="lns:creditInformationMessage"/>
     <variable name="reply"
                messageType="lns:creditInformationMessage"/>
   </variables>
   
   <correlationSets>
       <correlationSet name="customerCorr"
            properties="lns:nameProp lns:amountProp"/>
        
   </correlationSets>
   

   <sequence>
     <receive partnerLink="customerA"
              portType="lns:loanServicePT"
              operation="request1"
              variable="request" createInstance="yes">
         <correlations>
                 <correlation set="customerCorr"
                              initiate="yes"/>
         </correlations>
         
     </receive>
     
     <receive partnerLink="customerB"
              portType="lns:loanServicePT"
              operation="request2"
              variable="request">
         <correlations>
                 <correlation set="customerCorr"
                              initiate="no"/>
         </correlations>
         
     </receive>
     
     <invoke partnerLink="echoer"
             portType="lns:loanServicePT"
             operation="request3"
             inputVariable="request"
             outputVariable="reply" />

   </sequence>

</process>
